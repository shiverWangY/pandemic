(function(t){function e(e){for(var i,o,c=e[0],l=e[1],s=e[2],u=0,h=[];u<c.length;u++)o=c[u],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&h.push(r[o][0]),r[o]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);d&&d(e);while(h.length)h.shift()();return a.push.apply(a,s||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],i=!0,c=1;c<n.length;c++){var l=n[c];0!==r[l]&&(i=!1)}i&&(a.splice(e--,1),t=o(o.s=n[0]))}return t}var i={},r={app:0},a=[];function o(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=i,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=e,c=c.slice();for(var s=0;s<c.length;s++)e(c[s]);var d=l;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0373":function(t,e,n){},"2aef":function(t,e,n){"use strict";n("0373")},"4a6e":function(t,e,n){"use strict";n("f8b0")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("7a23"),r={id:"main_div"};function a(t,e,n,a,o,c){var l=Object(i["n"])("HelloWorld");return Object(i["i"])(),Object(i["d"])("div",r,[Object(i["f"])(l)])}n("b0c0");var o=function(t){return Object(i["k"])("data-v-e1434226"),t=t(),Object(i["j"])(),t},c=["dx"],l={key:0,points:"0,13 25,0 0,-13",stroke:"white"},s={key:1,y:"-13",x:"-5",width:"25",height:"25",stroke:"white"},d=o((function(){return Object(i["e"])("rect",{stroke:"white",height:"30",width:"90",fill:"none",rx:"5"},null,-1)})),u={dy:"18",dx:"45","text-anchor":"middle",fill:"white","font-size":"16","font-weight":"bold"},h={id:"background"},f=["d"],b=["d"],g=["d"],p=["dx","dy"],_={id:"people"},x=["cx","cy","r","fill"],j=["max"],y=["dx"],O=o((function(){return Object(i["e"])("g",{id:"ranking"},null,-1)})),m={id:"axis"},w=["y2"],k=o((function(){return Object(i["e"])("line",{x1:"30",x2:"26",y1:"25",y2:"32",stroke:"white"},null,-1)})),v=o((function(){return Object(i["e"])("line",{x1:"30",x2:"34",y1:"25",y2:"32",stroke:"white"},null,-1)})),F=["x1","x2","y1","y2"],A=["x1","x2","y1","y2"],E=["x2","y1","y2"],P={id:"lines"},S=["d","stroke"],z={id:"legend"},B=["transform"],I=["fill"],H={fill:"white","font-size":"12","text-anchor":"start",dx:"15",dy:"9"},M=["x","height"];function N(t,e,n,r,a,o){return Object(i["i"])(),Object(i["d"])(i["a"],null,[(Object(i["i"])(),Object(i["d"])("svg",{style:Object(i["h"])(o.style),onClick:e[2]||(e[2]=function(t){return o.log()})},[Object(i["e"])("text",{fill:"white",dx:a.width-120,dy:30,"font-size":"22","font-weight":"bold"},Object(i["o"])(o.date_select),9,c),Object(i["e"])("g",{transform:"translate(125,30)",cursor:"pointer",onClick:e[0]||(e[0]=function(t){return a.time_flag=!a.time_flag})},[a.time_flag?Object(i["c"])("",!0):(Object(i["i"])(),Object(i["d"])("polygon",l)),a.time_flag?(Object(i["i"])(),Object(i["d"])("rect",s)):Object(i["c"])("",!0)]),Object(i["e"])("g",{transform:"translate(20,15)",onClick:e[1]||(e[1]=function(t){return a.cumulated=!a.cumulated}),cursor:"pointer"},[d,Object(i["e"])("text",u,Object(i["o"])(a.cumulated?"cumulated":"daily"),1)]),Object(i["e"])("g",h,[(Object(i["i"])(!0),Object(i["d"])(i["a"],null,Object(i["m"])(a.geo_data.outer.features,(function(t,e){return Object(i["i"])(),Object(i["d"])("path",{class:"outer",key:e,fill:"None",stroke:"white","stroke-opacity":"0.3","stroke-width":"0.5px",d:o.map_path(t)},null,8,f)})),128)),(Object(i["i"])(!0),Object(i["d"])(i["a"],null,Object(i["m"])(a.geo_data.outer2.features,(function(t,e){return Object(i["i"])(),Object(i["d"])("path",{class:"outer2",key:e,fill:"None",stroke:"white","stroke-opacity":"0.3","stroke-width":"0.5px",d:o.map_path(t)},null,8,b)})),128)),(Object(i["i"])(!0),Object(i["d"])(i["a"],null,Object(i["m"])(a.geo_data.inner.features,(function(t,e){return Object(i["i"])(),Object(i["d"])("path",{class:"inner",key:e,fill:"none",stroke:"white","stroke-opacity":"0.7","stroke-width":"2",d:o.map_path(t)},null,8,g)})),128)),(Object(i["i"])(!0),Object(i["d"])(i["a"],null,Object(i["m"])(a.geo_data.inner.features,(function(t,e){return Object(i["i"])(),Object(i["d"])("text",{class:"dis_label",key:e,fill:"white",dx:o.projection(t.properties.centroid)[0],dy:o.projection(t.properties.centroid)[1],"text-anchor":"middle","font-size":"12"},Object(i["o"])(t.properties.name),9,p)})),128))]),Object(i["e"])("g",_,[Object(i["e"])("g",null,[(Object(i["i"])(!0),Object(i["d"])(i["a"],null,Object(i["m"])(o.show_data,(function(t){return Object(i["i"])(),Object(i["d"])("circle",{class:"person",key:t.index,cx:o.projection(t.xy)[0],cy:o.projection(t.xy)[1],r:"无症状"==t.type?3:"轻型"==t.type?5:8,opacity:"0.7",fill:"无症状"==t.type?"#F6F7BB":"轻型"==t.type?"#FFBF81":"#FF5D53"},null,8,x)})),128))])])],4)),Object(i["r"])(Object(i["e"])("input",{type:"range",min:"0",max:o.date_list.length-1,"onUpdate:modelValue":e[3]||(e[3]=function(t){return a.date_index=t})},null,8,j),[[i["p"],a.date_index]]),(Object(i["i"])(),Object(i["d"])("svg",{style:Object(i["h"])(o.style2)},[Object(i["e"])("text",{dx:a.width/4,"text-anchor":"middle",fill:"white","font-size":"20",dy:"30","font-weight":"bold"},"Number of Infections: "+Object(i["o"])(a.cumulated?"cumulated":"daily"),9,y),O],4)),(Object(i["i"])(),Object(i["d"])("svg",{style:Object(i["h"])(o.style3),id:"svg3"},[Object(i["e"])("g",m,[Object(i["e"])("line",{x1:"30",x2:"30",y1:"25",y2:25+o.axis_config.height,stroke:"white"},null,8,w),k,v,Object(i["e"])("line",{x1:30+o.axis_config.width,x2:23+o.axis_config.width,y1:25+o.axis_config.height,y2:21+o.axis_config.height,stroke:"white"},null,8,F),Object(i["e"])("line",{x1:30+o.axis_config.width,x2:23+o.axis_config.width,y1:25+o.axis_config.height,y2:29+o.axis_config.height,stroke:"white"},null,8,A),Object(i["e"])("line",{x1:"30",x2:30+o.axis_config.width,y1:25+o.axis_config.height,y2:25+o.axis_config.height,stroke:"white"},null,8,E)]),Object(i["e"])("g",P,[(Object(i["i"])(!0),Object(i["d"])(i["a"],null,Object(i["m"])(o.line_data,(function(t,e){return Object(i["i"])(),Object(i["d"])("path",{key:e,d:o.line_g(t),stroke:a.color_scale2(e),fill:"none"},null,8,S)})),128))]),Object(i["e"])("g",z,[(Object(i["i"])(!0),Object(i["d"])(i["a"],null,Object(i["m"])(a.type_list,(function(t,e){return Object(i["i"])(),Object(i["d"])("g",{key:e,transform:"translate("+(e*o.axis_config.width/5+130)+",10)"},[Object(i["e"])("rect",{height:"10",width:"10",fill:a.color_scale2(e),rx:"3"},null,8,I),Object(i["e"])("text",H,Object(i["o"])(t),1)],8,B)})),128))]),Object(i["e"])("rect",{id:"move",fill:"black",x:30+a.date_index*(o.axis_config.width/o.date_list.length)+o.axis_config.width/o.date_list.length,y:"33",height:o.axis_config.height-13,width:"1000"},null,8,M)],4))],64)}n("4de4"),n("d3b7"),n("4e82"),n("6062"),n("3ca3"),n("ddb0"),n("a630"),n("ac1f"),n("1276"),n("d81d");var W=n("6e58"),C={name:"maps",data:function(){return{width:2*document.documentElement.clientWidth/3,height:document.documentElement.clientHeight-20,geo_data:{inner:{},outer:{},outer2:{}},event_data:[],date_index:0,cumulated:!0,time_flag:!1,timer:0,color_scale:W["scale"].category20c(),color_scale2:W["scale"].category20(),type_list:["无症状","轻型","普通型"]}},mounted:function(){var t=this;W["json"]("北京市.json",(function(e){t.geo_data.inner=e})),W["json"]("河北省.json",(function(e){t.geo_data.outer=e})),W["json"]("天津市.json",(function(e){t.geo_data.outer2=e})),W["csv"]("event.csv",(function(e){t.event_data=e}))},computed:{line_data:function(){for(var t=this,e=[],n=["无症状","轻型","普通型"],i=function(i){for(var r=[],a=function(e){var a=new Object;a.x=e;var o=t.daily.filter((function(r){return r.date==t.date_list[e]&&r.type==n[i]})).length;a.y=o,r.push(a)},o=0;o<t.date_list.length;o++)a(o);e.push(r)},r=0;r<n.length;r++)i(r);return W["layout"].stack().offset(0)(e)},line_g:function(){var t=W["scale"].linear().domain([0,this.date_list.length-1]).range([30,this.axis_config.width+30]),e=W["scale"].linear().domain([100,-10]).range([25,this.axis_config.height+25]);return W["svg"].line().interpolate("basis").x((function(e){return t(e.x)})).y((function(t){return e(t.y+t.y0)}))},axis_config:function(){return{width:this.width/2-25-60,height:this.height/3-5-50}},watcher:function(){return this.bar_data.length},rank:function(){for(var t=[],e=0;e<this.bar_data.length;e++)t.push(this.bar_data[e].name);return t},length_scale:function(){return W["scale"].linear().domain([0,400]).range([100,this.width/2])},bar_data:function(){for(var t=this,e=[],n=function(n){var i=t.district_list[n],r=new Object;r.name=i;var a=t.show_data.filter((function(t){return t.district==i})).length;r.count=a,e.push(r)},i=0;i<this.district_list.length;i++)n(i);return e.sort((function(t,e){return e.count-t.count}))},district_list:function(){for(var t=new Set,e=0;e<this.daily.length;e++)t.add(this.daily[e].district);return Array.from(t)},show_data:function(){var t=this;return this.cumulated?this.daily.filter((function(e){return e.date<=t.date_select})):this.daily.filter((function(e){return e.date==t.date_select}))},date_select:function(){return this.date_list[this.date_index]},date_list:function(){for(var t=new Set,e=0;e<this.daily.length;e++)t.add(this.daily[e].date);return Array.from(t).sort((function(t,e){return t-e}))},daily:function(){for(var t=[],e=0;e<this.event_data.length;e++){var n=this.event_data[e],i=parseInt(n["24时日期"].substring(0,4)+n["24时日期"].substring(5,7)+n["24时日期"].substring(8,10));if(i){var r=new Object;r.date=i,r.id=n["感染者编号"]?n["感染者编号"]:"Unknown",r.index=n["表格ID"],r.daily_index=n["每日编号"],r.type=n["未命名1"],r.district=n["区"],r.address=n["居住地址"],r.source=n["上游"]?n["上游"]:"Unknown",r.source_address=n["上游地址"],r.data_problem=n["数据问题"]?n["数据问题"]:"No problem.";var a=n["坐标"].substring(6,n["坐标"].length-1).split(" ");r.xy=a.map((function(t){return parseFloat(t)}));var o=n["上游坐标"]?n["上游坐标"].substring(6,n["坐标"].length-1).split(" "):0;r.source_xy=o?o.map((function(t){return parseFloat(t)})):0,t.push(r)}}return t},projection:function(){return W["geo"].mercator().center([116.418757,40.47544]).scale(34e3*this.width/1800)},map_path:function(){return W["geo"].path().projection(this.projection)},style:function(){return"background-color:black;position:absolute;border-radius: 15px;top:10px;border:1.5px solid #0E021B;width:"+this.width+"px;height:"+this.height+"px;"},style2:function(){return"background-color:black;position:absolute;border-radius: 15px;top:10px;left:"+(this.width+15)+";border:1.5px solid #0E021B;width:"+(this.width/2-25)+"px;height:"+2*this.height/3+"px;"},style3:function(){return"background-color:black;position:absolute;border-radius: 15px;top:"+(2*this.height/3+15)+"px;left:"+(this.width+15)+";border:1.5px solid #0E021B;width:"+(this.width/2-25)+"px;height:"+(this.height/3-5)+"px;"}},methods:{log:function(){console.log(this.event_data),console.log(this.daily),console.log(this.date_list),console.log(this.show_data),console.log(this.district_list),console.log(this.bar_data),console.log(this.line_data)},rank_updater:function(){var t=this;W["select"]("#ranking").selectAll(".bars").data(this.district_list).enter().append("rect").attr("class","bars").attr("x",20).attr("height",2*this.height/3/this.district_list.length-10).attr("stroke-opacity",0),W["select"]("#ranking").selectAll(".bars").data(this.district_list).transition().duration(800).attr("y",(function(e){return t.rank.indexOf(e)*(2*t.height/3/t.district_list.length-5)+50})).attr("stroke",(function(e){return t.color_scale(e)})).attr("width",(function(e){return t.length_scale(t.bar_data[t.rank.indexOf(e)].count)})).attr("stroke-opacity",1),W["select"]("#ranking").selectAll(".texts").data(this.district_list).enter().append("text").attr("class","texts").attr("fill","white").attr("font-size",14).attr("text-anchor","middle").attr("fill-opacity",0),W["select"]("#ranking").selectAll(".texts").data(this.district_list).transition().duration(800).attr("dx",(function(e){return t.length_scale(t.bar_data[t.rank.indexOf(e)].count)/2+20})).attr("dy",(function(e){return t.rank.indexOf(e)*(2*t.height/3/t.district_list.length-5)+65})).attr("fill-opacity",1).text((function(e){return e+" ："+t.bar_data[t.rank.indexOf(e)].count}))}},watch:{time_flag:function(t){var e=this;t?this.timer=setInterval((function(){e.date_index<e.date_list.length-1?e.date_index++:e.time_flag=!1}),2e3):clearInterval(this.timer)},date_index:function(){this.rank_updater()},watcher:function(){this.rank_updater()}}},U=(n("4a6e"),n("6b0d")),D=n.n(U);const J=D()(C,[["render",N],["__scopeId","data-v-e1434226"]]);var T=J,V={name:"App",components:{HelloWorld:T},data:function(){return{width:document.documentElement.clientWidth-60,height:document.documentElement.clientHeight-60}}};n("2aef");const q=D()(V,[["render",a]]);var G=q,K=n("5502"),L=Object(K["a"])({state:{},mutations:{},actions:{},modules:{}});Object(i["b"])(G).use(L).mount("#app")},f8b0:function(t,e,n){}});
//# sourceMappingURL=app.e27d9589.js.map